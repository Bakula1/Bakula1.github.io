<!DOCTYPE html>
<html lang="hr">
<head>
	<meta charset="UTF-8">
	<title>Timer za raspored sati</title>
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
	<style>
		@media (max-width: 600px) {
			.sat-container {
				display: block;
				padding: 18px 6px;
				margin: 18px auto 0 auto;
				max-width: 98vw;
				box-shadow: 0 1px 6px rgba(0,0,0,0.08);
			}
			.sat-slika {
				width: 90vw;
				max-width: 320px;
				height: auto;
				margin: 0 auto 18px auto;
			}
			.sat-info {
				font-size: 1.08em;
				padding: 0 2vw;
			}
			.sat-info-row {
				font-size: 1em;
				padding-bottom: 0.5em;
			}
			h1 {
				font-size: 1.5em;
				margin-top: 18px;
			}
			#timer {
				font-size: 1.2em;
				margin: 18px 0 10px 0;
			}
		}
		body {
			font-family: 'Inter', Arial, sans-serif;
			background: #f7f7f7;
			margin: 0;
			min-height: 100vh;
			display: flex;
			flex-direction: column;
			align-items: center;
		}
		h1 {
			margin-top: 48px;
			font-weight: 700;
			font-size: 2.6em;
			letter-spacing: 1px;
		}
		.sat-container {
			display: grid;
			grid-template-columns: 420px 1fr;
			gap: 48px;
			align-items: center;
			background: #fff;
			box-shadow: 0 2px 12px rgba(0,0,0,0.08);
			border-radius: 18px;
			padding: 40px 32px;
			margin: 40px auto 0 auto;
			max-width: 950px;
			justify-content: center;
		}
		.sat-slika {
			width: 400px;
			height: 400px;
			object-fit: contain;
			background: #eee;
			border-radius: 12px;
			display: block;
			margin: 0 auto;
		}
		.sat-info {
			text-align: center;
			font-size: 1.35em;
			line-height: 2.1;
			letter-spacing: 0.5px;
		}
		.sat-info-row {
			display: block;
			margin-bottom: 0.2em;
			padding: 0 0 0.7em 0;
			border-bottom: 1.5px solid #ccc;
		}
		.sat-info-row:last-child {
			border-bottom: none;
		}
		.sat-info-row b {
			margin-right: 0.3em;
		}
		.sat-info b {
			font-size: 1.25em;
			font-weight: 600;
			margin-bottom: 18px;
			display: block;
		}
		#timer {
			font-size: 2.2em;
			margin: 32px 0 18px 0;
			text-align: center;
			letter-spacing: 1px;
		}
		#status {
			font-size: 1.2em;
			color: #555;
			margin-bottom: 18px;
			text-align: center;
		}
		button {
			font-size: 1.08em;
			padding: 10px 22px;
			border-radius: 10px;
			border: none;
			background: #1976d2;
			color: #fff;
			margin: 12px;
			cursor: pointer;
			box-shadow: 0 1px 4px rgba(0,0,0,0.07);
			transition: background 0.2s;
		}
		button:disabled {
			background: #aaa;
		}
	</style>
</head>
<body>
	<h1>Timer za raspored sati</h1>
	<div id="currentTime" style="font-size:2em;text-align:center;margin-bottom:10px;"></div>
	<div id="sat"></div>
	<div id="timer"></div>
	<div id="status"></div>
	<button id="endEarlyBtn" style="display:none;margin-top:20px;">Završi sat ranije</button>
	<button id="undoEndEarlyBtn" style="display:none;margin-top:10px;">Vrati sat natrag</button>
	<script>
	// Prikaz realnog trenutnog vremena s uređaja
	function updateCurrentTime() {
		const now = new Date();
		const hh = String(now.getHours()).padStart(2, '0');
		const mm = String(now.getMinutes()).padStart(2, '0');
		const ss = String(now.getSeconds()).padStart(2, '0');
		document.getElementById('currentTime').textContent = `${hh}:${mm}:${ss}`;
	}
	setInterval(updateCurrentTime, 1000);
	updateCurrentTime();

	// Rasporedi po tjednima (1-15), svaki tjedan ima raspored po danima
	const rasporediPoTjednima = {};
	for (let t = 1; t <= 15; t++) {
		// Rasporedi po tjednima (1-15), svaki tjedan ima svoj objekt
		rasporediPoTjednima[1] = {
			3: [ /* srijeda */
				{ predmet: "Objektno orijentirano programiranje", start: "15:00", end: "18:15", profesor: "Damir Blažević", ucionica: "T2-31", vrsta: "Predavanje", prisutnost: "Prozivanje", slika: "damir_blazevic.jpg" },
				
			],
			4: [ /* četvrtak */
				{ predmet: "Operacijski sustavi", start: "16:45", end: "20:00", profesor: "Goran Martinović", ucionica: "K2-1", vrsta: "Predavanje", prisutnost: "Prozivanje", slika: "goran_martinovic.jpg" }
			],
			5: [ /* petak */
				{ predmet: "Algoritmi i strukture podataka", start: "13:15", end: "16:30", profesor: "Alfonzo Baumgartner", ucionica: "K2-1", vrsta: "Predavanje", prisutnost: "Prozivanje", slika: "alfonzo_baumgartner.jpg" },
				{ predmet: "Linearna algebra II", start: "16:45", end: "20:00", profesor: "Anita Katić", ucionica: "K2-1", vrsta: "Predavanje", prisutnost: "Potpis", slika: "anita_katic.jpg" }
				
			]
		};

		// PRIMJER: Tjedan 2
		rasporediPoTjednima[2] = {
			1: [ /* ponedjeljak */
				{ predmet: "Baze podataka", start: "13:15", end: "16:30", profesor: "Ivica Lukić", ucionica: "T2-31", vrsta: "Predavanje", prisutnost: "Potpis", slika: "ivica_lukic.jpg" },{ predmet: "Tjelesna kultura III", start: "17:00", end: "18:30", profesor: "Petar Kerže", ucionica: "T2-31", vrsta: "LV", prisutnost: "Obavezno", slika: "petar_kerze.jpg" },
				],
			2: [ /* utorak */
				{ predmet: "Objektno orijentirano programiranje", start: "13:15", end: "16:30", profesor: "Damir Blažević", ucionica: "T2-31", vrsta: "Predavanje", prisutnost: "Prozivanje", slika: "damir_blazevic.jpg" },
				{ predmet: "Baze podataka", start: "16:45", end: "18:15", profesor: "Krešimir Romić", ucionica: "T2-31", vrsta: "AV", prisutnost: "Potpis", slika: "kresimir_romic.jpg" },
				],
			3: [ /* srijeda */
				{ predmet: "Algoritmi i strukture podataka", start: "11:30", end: "14:45", profesor: "Alfonzo Baumgartner", ucionica: "K2-1", vrsta: "Predavanje", prisutnost: "Prozivanje", slika: "alfonzo_baumgartner.jpg" },
				{ predmet: "Algoritmi i strukture podataka", start: "15:00", end: "16:30", profesor: "Tomislav Galba", ucionica: "K2-1", vrsta: "AV", prisutnost: "Prozivanje", slika: "tomislav_galba.jpg" },
				
			],
			4: [ /* četvrtak */
				{ predmet: "Operacijski sustavi", start: "08:00", end: "11:15", profesor: "Goran Martinović", ucionica: "T2-31", vrsta: "Predavanje", prisutnost: "Prozivanje", slika: "goran_martinovic.jpg" },
				{ predmet: "Objektno orijentirano programiranje", start: "13:15", end: "14:45", profesor: "Bruno Zorić", ucionica: "T2-31", vrsta: "AV", prisutnost: "Nije obavezno", slika: "bruno_zoric.jpg" },
			],
			5: [ /* petak */
				
				{ predmet: "Linearna algebra II", start: "11:30", end: "14:45", profesor: "Anita Katić", ucionica: "T2-31", vrsta: "Predavanje", prisutnost: "Potpis", slika: "anita_katic.jpg" }
				
			]
		};

		// Dodajte rasporede za tjedne 3-15 po istom principu
	}

	// Početak semestra (prvi tjedan): 29.9.2025
	const datumPocetka = new Date(2025, 8, 29); // mjesec je 0-indeksiran
	function getTrenutniTjedan() {
		const danas = new Date();
		const diff = Math.floor((danas - datumPocetka) / (1000 * 60 * 60 * 24));
		const tjedan = Math.floor(diff / 7) + 1;
		return Math.max(1, Math.min(15, tjedan));
	}

	function getRasporedZaTjedan(tjedan) {
		return rasporediPoTjednima[tjedan] || {};
	}
		// ...existing code...

	function getDanasnjiRaspored() {
		const dan = new Date().getDay();
		const tjedan = getTrenutniTjedan();
		const rasporedTjedan = getRasporedZaTjedan(tjedan);
		return rasporedTjedan[dan] || [];
	}

	function parseTime(str) {
		const [h, m] = str.split(":").map(Number);
		const now = new Date();
		now.setHours(h, m, 0, 0);
		return now;
	}


	function getCurrentSat(raspored) {
		const now = new Date();
		for (const sat of raspored) {
			const start = parseTime(sat.start);
			const end = parseTime(sat.end);
			if (now >= start && now <= end) {
				return { ...sat, start, end };
			}
		}
		return null;
	}


	function getNextSatGlobal() {
		const now = new Date();
		let tjedan = getTrenutniTjedan();
		for (let dayOffset = 0; dayOffset < 15 * 7; dayOffset++) { // max 15 tjedana unaprijed
			const future = new Date(now.getFullYear(), now.getMonth(), now.getDate() + dayOffset);
			const dan = future.getDay();
			// Izračunaj tjedan za budući datum
			const diff = Math.floor((future - datumPocetka) / (1000 * 60 * 60 * 24));
			const futureTjedan = Math.floor(diff / 7) + 1;
			if (futureTjedan < 1 || futureTjedan > 15) continue;
			const raspored = getRasporedZaTjedan(futureTjedan)[dan] || [];
			for (const sat of raspored) {
				const [h, m] = sat.start.split(":").map(Number);
				const start = new Date(future.getFullYear(), future.getMonth(), future.getDate(), h, m, 0, 0);
				if (start > now) {
					return { ...sat, start, dan, offset: dayOffset, tjedan: futureTjedan };
				}
			}
		}
		return null;
	}




	let endEarlySat = null;

	function updateTimer() {
		const satDiv = document.getElementById("sat");
		const timerDiv = document.getElementById("timer");
		const statusDiv = document.getElementById("status");
		const endEarlyBtn = document.getElementById("endEarlyBtn");
		const undoEndEarlyBtn = document.getElementById("undoEndEarlyBtn");
		const dani = ["Nedjelja", "Ponedjeljak", "Utorak", "Srijeda", "Četvrtak", "Petak", "Subota"];
		const danas = new Date().getDay();
		const raspored = getDanasnjiRaspored();
		document.title = `Timer za raspored sati - ${dani[danas]}`;
		let current = getCurrentSat(raspored);
		if (endEarlySat && current && current.start.getTime() === endEarlySat.start.getTime()) {
			// Sat je ručno završen
			current = null;
			undoEndEarlyBtn.style.display = "inline-block";
		} else {
			undoEndEarlyBtn.style.display = "none";
		}
		if (current) {
			satDiv.innerHTML = `
			<div class='sat-container'>
				<img class='sat-slika' src='${current.slika}' alt='${current.profesor}'>
				<div class='sat-info'>
					<b>${current.predmet}</b><br>
					<span class='sat-info-row'><b>Vrsta:</b> ${current.vrsta}</span>
					<span class='sat-info-row'><b>Profesor:</b> ${current.profesor}</span>
					<span class='sat-info-row'><b>Učionica:</b> ${current.ucionica}</Sspan>
					<span class='sat-info-row' style='font-size:1em;color:#000;'><b>Prisutnost:</b> ${current.prisutnost || ""}</span>
				</div>
			</div>`;
			const remaining = Math.floor((current.end - new Date()) / 1000);
			const min = Math.floor(remaining / 60);
			const sec = remaining % 60;
			timerDiv.textContent = `Do kraja sata: ${min.toString().padStart(2, "0")}:${sec.toString().padStart(2, "0")}`;
			statusDiv.textContent = "";
			endEarlyBtn.style.display = "inline-block";
			endEarlyBtn.disabled = false;
		} else {
			endEarlyBtn.style.display = "none";
			const nextGlobal = getNextSatGlobal();
			// Provjeri je li sljedeći sat danas
			if (nextGlobal && nextGlobal.offset === 0) {
				const diff = Math.floor((nextGlobal.start - new Date()) / 1000);
				const danTekst = "danas";
				const hours = Math.floor(diff / 3600);
				const min = Math.floor((diff % 3600) / 60);
				const sec = diff % 60;
				satDiv.innerHTML = `
				<div class='sat-container'>
					<img class='sat-slika' src='${nextGlobal.slika}' alt='${nextGlobal.profesor}'>
					<div class='sat-info'>
						<b>${nextGlobal.predmet}</b><br>
						<span class='sat-info-row'><b>Vrsta:</b> ${nextGlobal.vrsta}</span>
						<span class='sat-info-row'><b>Profesor:</b> ${nextGlobal.profesor}</span>
						<span class='sat-info-row'><b>Učionica:</b> ${nextGlobal.ucionica}</span>
						<span class='sat-info-row' style='font-size:1em;color:#000;'><b>Prisutnost:</b> ${nextGlobal.prisutnost || ""}</span>
						<span style='font-size:0.9em;color:#888;'>(${dani[nextGlobal.dan]}, ${nextGlobal.start.getHours().toString().padStart(2, "0")}:${nextGlobal.start.getMinutes().toString().padStart(2, "0")})</span>
					</div>
				</div>`;
				timerDiv.textContent = `Odbrojavanje do sljedećeg sata (${danTekst}): ${hours.toString().padStart(2, "0")}:${min.toString().padStart(2, "0")}:${sec.toString().padStart(2, "0")}`;
				statusDiv.textContent = "";
			} else if (nextGlobal) {
				// Sljedeći sat je neki drugi dan
				const diff = Math.floor((nextGlobal.start - new Date()) / 1000);
				const danTekst = `za ${nextGlobal.offset} dan(a)`;
				const hours = Math.floor(diff / 3600);
				const min = Math.floor((diff % 3600) / 60);
				const sec = diff % 60;
				satDiv.innerHTML = `
				<div class='sat-container'>
					<img class='sat-slika' src='${nextGlobal.slika || ""}' alt='${nextGlobal.profesor || ""}'>
					<div class='sat-info'>
						<b>${nextGlobal.predmet || ""}</b><br>
						<span class='sat-info-row'><b>Vrsta:</b> ${nextGlobal.vrsta || ""}</span>
						<span class='sat-info-row'><b>Profesor:</b> ${nextGlobal.profesor || ""}</span>
						<span class='sat-info-row'><b>Učionica:</b> ${nextGlobal.ucionica || ""}</span>
						<span class='sat-info-row' style='font-size:1em;color:#000;'><b>Prisutnost:</b> ${nextGlobal.prisutnost || ""}</span>
						<span style='font-size:0.9em;color:#888;'>(${dani[nextGlobal.dan]}, ${nextGlobal.start.getHours().toString().padStart(2, "0")}:${nextGlobal.start.getMinutes().toString().padStart(2, "0")})</span>
					</div>
				</div>`;
				timerDiv.textContent = `Odbrojavanje do sljedećeg sata (${danTekst}): ${hours.toString().padStart(2, "0")}:${min.toString().padStart(2, "0")}:${sec.toString().padStart(2, "0")}`;
				statusDiv.textContent = "Gotov si za danas!";
			} else {
				satDiv.textContent = "";
				timerDiv.textContent = "";
				statusDiv.textContent = "Nema više nastave u rasporedu!";
			}
		}
	}

	document.getElementById("endEarlyBtn").onclick = function() {
		const raspored = getDanasnjiRaspored();
		const current = getCurrentSat(raspored);
		if (current) {
			endEarlySat = current;
			this.disabled = true;
		}
	};

	document.getElementById("undoEndEarlyBtn").onclick = function() {
		endEarlySat = null;
		this.style.display = "none";
	};

	setInterval(updateTimer, 1000);
	updateTimer();
	</script>
</body>
</html>
